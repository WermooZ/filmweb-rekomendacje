<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
</head>
<body>
<div id="main">
    <div id="example">
        <div v-for="m in dane">
            <span>[[m.originalTitle]] ([[m.Gatunek]]): </span> [[m.Ocena]]
        </div>
    </div>
    <div>
        <canvas id="myChart" width="400" height="400"></canvas>
    </div>
    <div>
        <canvas id="flowChart" width="400" height="400"></canvas>
    </div>
    <div>
        <canvas id="radarChart" width="400" height="400"></canvas>
    </div>
</div>
<script>
function decodeHtml(html) {
    var txt = document.createElement("textarea");
    txt.innerHTML = html;
    return txt.value;

}
var dane_gatunki =  {{ dane_gatunki|safe }}
var radar =  {{ radar|safe }}
var flow =  {{ flow|safe }}

function getRandomColor(n) {
    var letters = '0123456789ABCDEF'.split('');
    var color = '#';
    var colors = [];
    for(var j = 0; j < n; j++){
        for (var i = 0; i < 6; i++ ) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        colors.push(color);
        color = '#';
    }
    return colors;
}

var ctx = document.getElementById('myChart');

var myChart = new Chart(ctx, {
    type: 'pie',
    data: {
        labels: Object.keys(dane_gatunki),
         datasets: [{
            label: '# of Votes',
            data:  Object.values(dane_gatunki),
            backgroundColor: getRandomColor( Object.values(dane_gatunki).length)
         }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});

var flw = document.getElementById('flowChart');
var flowChart = new Chart(flw, {
		    type: 'line',
		    data: {
                labels: Object.values(flow['Data']),
		        datasets: [{
		            label: 'Filmweb',
                    data:  Object.values(flow['Ocena']),
		            backgroundColor: '#FF0000',
		            borderWidth: 0,
		            tension: 0,
    				fill: false
		        },{
		            label: 'IMDb',
                    data:  Object.values(flow['averageRating']),
		            backgroundColor: '#0000FF',
		            borderWidth: 0,
		            tension: 0,
    				fill: false
		        },{
		            label: 'Rating difference',
                    data:  Object.values(flow['diff']),
		            backgroundColor: '#00FF00',
		            borderWidth: 0,
		            tension: 0,
    				fill: false
		        }]
		    },
		    options: {
		    	title: {
		    		text: 'SCORE FLOW',
		    		display: true
		    	},
		        scales: {
		            yAxes: [{
		                ticks: {
		                    beginAtZero: true,
		                    min: -10,
		                    max: 10,
		                    stepSize: 1
		                },
		                gridLines: {
		                	zeroLineWidth: 3
		                }
		            }]
		        },
                layout: {
		            padding: 40
                },
                elements:{
                	point: {
						radius:2,
						pointStyle: 'circle'
					}
                }
		    }
		});

var rdr = document.getElementById('radarChart');
var radarChart = new Chart(rdr, {
		    type: 'radar',
		    data: {
                labels: Object.keys(radar['fw']),
		        datasets: [{
		            label: 'Filmweb',
                    data:  Object.values(radar['fw']),
		            borderColor: '#FF0000',
		            backgroundColor: 'rgba(255, 0, 0, 0.5)',
		            borderWidth: 2,
    				fill: true
		        },{
		            label: 'IMDb',
                    data:  Object.values(radar['imdb']),
		            borderColor: '#0000FF',
		            backgroundColor: 'rgba(0, 0, 255, 0.5);',
		            borderWidth: 2,
    				fill: true
		        }]
		    },
		    options: {
		    	title: {
		    		text: 'SCORE RADAR',
		    		display: true
		    	}
		    }
		});

new Vue({
    el: '#example',
    delimiters: ['[[', ']]'],
    data: {
        hello: 'Hello World!',
        dane: ''
     },
    mounted: function () {

    },
    methods: {
        submit_form: function (e) {
            print('Form submitted', e)
        }
    }
})

</script>
</body>
</html>